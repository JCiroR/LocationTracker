<div class="">
  <div class="">

  
    <%= form_for [current_user, current_user.points.build] do |f| %>
      <%= f.hidden_field :lat %>
      <br>
      <%= f.hidden_field :lon %>
    <% end %>
    <button onclick="getLocation()" class="btn-record">Record location</button>
  </div>
</div>

<p id="result"></p>   

<script>
    var x = document.getElementById("result");
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError);
        } else { 
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
    }

    function showPosition(position) {  
        document.getElementById("point_lat").value = position.coords.latitude;
        document.getElementById("point_lon").value = position.coords.longitude;
        document.getElementById("new_point").submit();
    }

    function showError(error) {
        switch(error.code) {
            case error.PERMISSION_DENIED:
                x.innerHTML = "The request for Geolocation was denied."
                break;
            case error.POSITION_UNAVAILABLE:
                x.innerHTML = "Location information is unavailable."
                break;
            case error.TIMEOUT:
                x.innerHTML = "The request to get user location timed out."
                break;
            case error.UNKNOWN_ERROR:
                x.innerHTML = "An unknown error occurred."
                break;
        }
    }
</script>


